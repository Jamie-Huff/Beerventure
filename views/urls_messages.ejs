<!doctype html>

<html lang="en">
<head>
  <!-- internal css -->
  <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" type="text/css">
  <link rel="stylesheet" href="/styles/messages.css" type="text/css" />


  <!-- internal js -->
  <!-- <script type="text/javascript" src="/vendor/jquery-3.0.0.js"></script> -->

  <!-- external css -->

  <!-- external js -->

</head>

<body>
  <%- include('partials/_navbarSignedIn') %>

  <% if (!userEmail) { %>
    <%- include('partials/_error') %>
  <% } else { %>

    <h1>My Messages</h1>

    <section class="message-page">

      <% if (!isVendor) { %>

        <% for (const convo of arrayofConvos) { %>
          <div class="convo-title">
            CONVERATION WITH: <%= convo[0].vendor_name %>
          </div>

          <div class="convos">

          <% for (let i = 0 ; i < convo.length; i++) { %>

            <% if (!convo[i].is_vendor) { %>

              <div>
                <p>User: <%= convo[i].message %> </p>
              </div>

            <% } else { %>

              <div>
                <p>Vendor: <%= convo[i].message %> </p>
              </div>

            <% } %>

          <% } %>
          </div>
          <form class="send-message" action="/messages/<%= userID %>" method="POST">
            <input type="hidden" value="<%= convo[0].vendor_id %>" name="vendor_id"/>
            <textarea class="msg" name="text" placeholder="Type message here..."></textarea>
            <button type="submit">Send</button>
          </form>


        <% } %>

        <div class="msg-vendor">

          CONTACT A VENDOR)
          <form action="/messages/<%= userID %>" method="POST">
            Name of Vendor:<br>
            <input type="text" name="vendor_name"><br><br>
            Message:<br>
            <input type="hidden"/>
            <textarea name="text" placeholder="Describe your item..."></textarea>
            <br><br>
            <button type="submit">Start Conversation</button>
          </form>

        </div>



      <% } else { %>

        <% for (const convo of arrayofConvos) { %>
          <div class="convo-title">
            CONVERATION WITH: <%= convo[0].user_name %>
          </div>

          <div class="convos">

          <% for (let i = 0; i < convo.length; i++) { %>

            <% if (convo[i].is_vendor) { %>

              <div>
                <p>Vendor: <%= convo[i].message %> </p>
              </div>

            <% } else { %>

              <div>
                <p>User: <%= convo[i].message %> </p>
              </div>

            <% } %>

          <% } %>
          </div>
          <form class="send-message" action="/messages/<%= userID %>" method="POST">
            <input type="hidden" value="<%= convo[0].user_id %>" name="user_id"/>
            <textarea class="msg" name="text" placeholder="Type message here..."></textarea>
            <button type="submit">Send</button>
          </form>
        <% } %>

        <div class="msg-user">

          CONTACT A USER)
          <form action="/messages/<%= userID %>" method="POST">
            Name of USER:<br>
            <input type="text" name="user_name"><br><br>
            Message:<br>
            <input type="hidden"/>
            <textarea name="text" placeholder="Describe your item..."></textarea>
            <br><br>
            <button type="submit">Start Conversation</button>
          </form>

        </div>

      <% } %>


    </section>

  <% } %>

  <%- include('partials/_footer'); %>



</body>
</html>
